#ifndef __APPLICATIONS_WEATHER_WEATHER_H__
#define __APPLICATIONS_WEATHER_WEATHER_H__
#include "../../GUI/Panel.hpp"
#include "../../GUI/Canvas.hpp"
#include "../../GUI/Component.hpp"
#include "../../Devices/Button.hpp"
#include "../../System/Application.hpp"
#include "../../System/Timer.hpp"
#include "../../System/System.hpp"
#include "../../System/DeviceManager.hpp"
#include "../../Devices/Display.hpp"
#include "../../Devices/Dht11.hpp"

namespace ptm
{
namespace applications
{
namespace weather
{

class Weather;
class Signs;

class Signs : public gui::Component
{
  public:
	Signs(uint32_t x, uint32_t y);
	Signs(uint32_t x, uint32_t y, bool flip_x);
    virtual ~Signs();
    virtual void paintOn(gui::Canvas *canvas);

  protected:
  private:
    u8 hundreds(u16 x);
    u8 tens(u16 x);
    u8 unity(u16 x);

    void paintUnity(u16 x);
    void paintTens(u16 x);
    void paintHundreds(u16 x);
    void paintTemp(u16 x);
    void paintRh(u16 x);

    uint8_t _current_frame;
    bool _reverse;
    bool _flip_x;
    bool _zero[8][12]=
      {
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0},
        { 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0},
        { 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0},
        { 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0},
        { 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0},
        { 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
      };

    bool _one[8][12]=
      {
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0},
        { 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
      };

    bool _two[8][12]=
      {
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0},
        { 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0},
        { 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0},
        { 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0},
        { 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0},
        { 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
      };

    bool _three[8][12]=
      {
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0},
        { 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0},
        { 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0},
        { 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0},
        { 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0},
        { 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
      };

    bool _four[8][12]=
      {
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0},
        { 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0},
        { 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 0},
        { 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0},
        { 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0},
        { 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
      };

    bool _five[8][12]=
      {
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0},
        { 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0},
        { 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0},
        { 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0},
        { 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0},
        { 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
      };

    bool _six[8][12]=
      {
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0},
        { 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0},
        { 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0},
        { 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0},
        { 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0},
        { 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
      };

    bool _seven[8][12]=
      {
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0},
        { 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0},
        { 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0},
        { 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0},
        { 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
      };

    bool _eight[8][12]=
      {
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0},
        { 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0},
        { 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0},
        { 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0},
        { 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0},
        { 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
      };

    bool _nine[8][12]=
      {
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0},
        { 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0},
        { 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0},
        { 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0},
        { 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0},
        { 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
      };

    bool _percent[13][12]=
      {
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0},
        { 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0},
        { 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0},
        { 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0},
        { 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0},
        { 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0},
        { 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0},
        { 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0},
        { 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0},
        { 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
      };

    bool _rh[22][12]=
      {
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0},
        { 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0},
        { 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0},
        { 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0},
        { 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0},
        { 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0},
        { 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0},
        { 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0},
        { 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0},
        { 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0},
        { 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0},
        { 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
      };

    bool _temp[41][15]=
      {
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0},
        { 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0},
        { 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0},
        { 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0},
        { 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0},
        { 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0},
        { 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0},
        { 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0},
        { 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0},
        { 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0},
        { 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0},
        { 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0},
        { 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0},
        { 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0},
        { 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0},
        { 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0},
        { 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        { 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0},
        { 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0},
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
      };

};


class Weather : public system::Application
{
  public:
    Weather();
    virtual ~Weather();
    virtual void onUpdate();
    virtual void onStart();
    virtual void onPause();
    virtual void onResume();
    virtual void onStop();
    void onScreenUpdate();
    gui::Panel _main_panel;
  protected:
    gui::MonochromaticCanvas _canvas;
    std::weak_ptr<devices::displays::IDisplay> _display;
    system::ManagedTimer _screen_timer;
  private:
};

}
}
}

#endif
